"""
Car Database — Built-in vehicle specs for the physics tool.
Each car has real-world baseline specs that drive the physics calculations.
"""

CAR_DATABASE = {
    # ── Nissan S-Chassis ──────────────────────────────────────────
    "nissan_s13_sr20": {
        "make": "Nissan", "model": "180SX / 240SX", "chassis": "S13",
        "year": "1989-1998", "engine": "SR20DET",
        "drivetrain": "RWD",
        "mass_kg": 1180,
        "wheelbase_m": 2.475,
        "track_f_m": 1.480, "track_r_m": 1.460,
        "weight_dist_f": 0.55,
        "cg_height_m": 0.46,
        # Stock suspension
        "susp_type_f": "STRUT", "susp_type_r": "MULTILINK",
        "spring_rate_f": 22000, "spring_rate_r": 18000,
        "arb_f": 18000, "arb_r": 8000,
        "hub_mass_f": 32.0, "hub_mass_r": 28.0,
        # Steering
        "steer_lock": 450, "steer_ratio": 17.0,
        "stock_max_angle": 36,
        # Brakes
        "brake_torque": 1600, "brake_bias": 0.62,
        "rotor_f_mm": 257, "rotor_r_mm": 258,
        # Tires
        "tire_width_f": 0.205, "tire_width_r": 0.205,
        "tire_aspect_f": 55, "tire_aspect_r": 55,
        "rim_dia_f": 16, "rim_dia_r": 16,
        # Diff
        "diff_type": "VLSD", "diff_power": 0.15, "diff_coast": 0.05, "diff_preload": 10,
        # Engine
        "power_hp": 205, "torque_nm": 275, "redline": 7200, "idle": 850,
        "fuel_capacity": 65,
    },
    "nissan_s14_sr20": {
        "make": "Nissan", "model": "Silvia / 240SX", "chassis": "S14",
        "year": "1994-1998", "engine": "SR20DET",
        "drivetrain": "RWD",
        "mass_kg": 1220,
        "wheelbase_m": 2.525,
        "track_f_m": 1.480, "track_r_m": 1.470,
        "weight_dist_f": 0.56,
        "cg_height_m": 0.46,
        "susp_type_f": "STRUT", "susp_type_r": "MULTILINK",
        "spring_rate_f": 24000, "spring_rate_r": 20000,
        "arb_f": 20000, "arb_r": 9000,
        "hub_mass_f": 33.0, "hub_mass_r": 29.0,
        "steer_lock": 450, "steer_ratio": 17.0,
        "stock_max_angle": 36,
        "brake_torque": 1800, "brake_bias": 0.62,
        "rotor_f_mm": 280, "rotor_r_mm": 258,
        "tire_width_f": 0.205, "tire_width_r": 0.225,
        "tire_aspect_f": 55, "tire_aspect_r": 50,
        "rim_dia_f": 16, "rim_dia_r": 16,
        "diff_type": "VLSD", "diff_power": 0.15, "diff_coast": 0.05, "diff_preload": 10,
        "power_hp": 220, "torque_nm": 275, "redline": 7200, "idle": 850,
        "fuel_capacity": 65,
    },
    "nissan_s15_sr20": {
        "make": "Nissan", "model": "Silvia Spec-R", "chassis": "S15",
        "year": "1999-2002", "engine": "SR20DET",
        "drivetrain": "RWD",
        "mass_kg": 1240,
        "wheelbase_m": 2.525,
        "track_f_m": 1.480, "track_r_m": 1.470,
        "weight_dist_f": 0.56,
        "cg_height_m": 0.45,
        "susp_type_f": "STRUT", "susp_type_r": "MULTILINK",
        "spring_rate_f": 26000, "spring_rate_r": 22000,
        "arb_f": 22000, "arb_r": 10000,
        "hub_mass_f": 33.0, "hub_mass_r": 29.0,
        "steer_lock": 450, "steer_ratio": 16.5,
        "stock_max_angle": 37,
        "brake_torque": 1900, "brake_bias": 0.62,
        "rotor_f_mm": 280, "rotor_r_mm": 258,
        "tire_width_f": 0.215, "tire_width_r": 0.225,
        "tire_aspect_f": 45, "tire_aspect_r": 45,
        "rim_dia_f": 17, "rim_dia_r": 17,
        "diff_type": "Helical LSD", "diff_power": 0.20, "diff_coast": 0.10, "diff_preload": 15,
        "power_hp": 250, "torque_nm": 275, "redline": 7200, "idle": 850,
        "fuel_capacity": 65,
    },

    # ── BMW E46 ───────────────────────────────────────────────────
    "bmw_e46_m3": {
        "make": "BMW", "model": "M3 (E46)", "chassis": "E46",
        "year": "2000-2006", "engine": "S54B32",
        "drivetrain": "RWD",
        "mass_kg": 1583,
        "wheelbase_m": 2.731,
        "track_f_m": 1.508, "track_r_m": 1.504,
        "weight_dist_f": 0.511,
        "cg_height_m": 0.47,
        "susp_type_f": "STRUT", "susp_type_r": "MULTILINK",
        "spring_rate_f": 30000, "spring_rate_r": 28000,
        "arb_f": 33557, "arb_r": 7692,
        "hub_mass_f": 46.97, "hub_mass_r": 38.50,
        "steer_lock": 540, "steer_ratio": 15.4,
        "stock_max_angle": 36,
        "brake_torque": 2600, "brake_bias": 0.64,
        "rotor_f_mm": 325, "rotor_r_mm": 328,
        "tire_width_f": 0.225, "tire_width_r": 0.255,
        "tire_aspect_f": 45, "tire_aspect_r": 40,
        "rim_dia_f": 18, "rim_dia_r": 18,
        "diff_type": "Variable M Diff", "diff_power": 0.25, "diff_coast": 0.10, "diff_preload": 20,
        "power_hp": 338, "torque_nm": 365, "redline": 8000, "idle": 750,
        "fuel_capacity": 63,
    },
    "bmw_e46_325": {
        "make": "BMW", "model": "325i (E46)", "chassis": "E46",
        "year": "1999-2005", "engine": "M54B25",
        "drivetrain": "RWD",
        "mass_kg": 1470,
        "wheelbase_m": 2.725,
        "track_f_m": 1.481, "track_r_m": 1.488,
        "weight_dist_f": 0.52,
        "cg_height_m": 0.48,
        "susp_type_f": "STRUT", "susp_type_r": "MULTILINK",
        "spring_rate_f": 22000, "spring_rate_r": 20000,
        "arb_f": 25000, "arb_r": 6000,
        "hub_mass_f": 40.0, "hub_mass_r": 35.0,
        "steer_lock": 540, "steer_ratio": 16.7,
        "stock_max_angle": 33,
        "brake_torque": 2000, "brake_bias": 0.62,
        "rotor_f_mm": 300, "rotor_r_mm": 294,
        "tire_width_f": 0.205, "tire_width_r": 0.225,
        "tire_aspect_f": 55, "tire_aspect_r": 50,
        "rim_dia_f": 16, "rim_dia_r": 16,
        "diff_type": "Open", "diff_power": 0.0, "diff_coast": 0.0, "diff_preload": 0,
        "power_hp": 184, "torque_nm": 245, "redline": 6500, "idle": 700,
        "fuel_capacity": 63,
    },

    # ── Toyota AE86 ──────────────────────────────────────────────
    "toyota_ae86": {
        "make": "Toyota", "model": "AE86 Corolla GT-S", "chassis": "AE86",
        "year": "1983-1987", "engine": "4A-GE",
        "drivetrain": "RWD",
        "mass_kg": 1010,
        "wheelbase_m": 2.400,
        "track_f_m": 1.355, "track_r_m": 1.340,
        "weight_dist_f": 0.57,
        "cg_height_m": 0.45,
        "susp_type_f": "STRUT", "susp_type_r": "4LINK",
        "spring_rate_f": 18000, "spring_rate_r": 16000,
        "arb_f": 12000, "arb_r": 5000,
        "hub_mass_f": 26.0, "hub_mass_r": 24.0,
        "steer_lock": 450, "steer_ratio": 18.0,
        "stock_max_angle": 32,
        "brake_torque": 1200, "brake_bias": 0.60,
        "rotor_f_mm": 238, "rotor_r_mm": 200,
        "tire_width_f": 0.185, "tire_width_r": 0.185,
        "tire_aspect_f": 70, "tire_aspect_r": 70,
        "rim_dia_f": 14, "rim_dia_r": 14,
        "diff_type": "Open", "diff_power": 0.0, "diff_coast": 0.0, "diff_preload": 0,
        "power_hp": 128, "torque_nm": 149, "redline": 7600, "idle": 800,
        "fuel_capacity": 50,
    },

    # ── Chevrolet Corvette C6 ────────────────────────────────────
    "chevy_c6_z06": {
        "make": "Chevrolet", "model": "Corvette Z06", "chassis": "C6",
        "year": "2006-2013", "engine": "LS7",
        "drivetrain": "RWD",
        "mass_kg": 1500,
        "wheelbase_m": 2.685,
        "track_f_m": 1.577, "track_r_m": 1.558,
        "weight_dist_f": 0.51,
        "cg_height_m": 0.42,
        "susp_type_f": "DWB", "susp_type_r": "DWB",
        "spring_rate_f": 45000, "spring_rate_r": 48000,
        "arb_f": 35000, "arb_r": 20000,
        "hub_mass_f": 42.0, "hub_mass_r": 40.0,
        "steer_lock": 450, "steer_ratio": 16.1,
        "stock_max_angle": 35,
        "brake_torque": 3200, "brake_bias": 0.63,
        "rotor_f_mm": 355, "rotor_r_mm": 340,
        "tire_width_f": 0.275, "tire_width_r": 0.325,
        "tire_aspect_f": 35, "tire_aspect_r": 30,
        "rim_dia_f": 18, "rim_dia_r": 19,
        "diff_type": "Limited Slip", "diff_power": 0.40, "diff_coast": 0.20, "diff_preload": 40,
        "power_hp": 505, "torque_nm": 637, "redline": 7100, "idle": 600,
        "fuel_capacity": 68,
    },

    # ── Mazda RX-7 ───────────────────────────────────────────────
    "mazda_fd3s": {
        "make": "Mazda", "model": "RX-7 Spirit R", "chassis": "FD3S",
        "year": "1992-2002", "engine": "13B-REW",
        "drivetrain": "RWD",
        "mass_kg": 1280,
        "wheelbase_m": 2.425,
        "track_f_m": 1.460, "track_r_m": 1.460,
        "weight_dist_f": 0.51,
        "cg_height_m": 0.44,
        "susp_type_f": "DWB", "susp_type_r": "DWB",
        "spring_rate_f": 35000, "spring_rate_r": 30000,
        "arb_f": 22000, "arb_r": 12000,
        "hub_mass_f": 30.0, "hub_mass_r": 28.0,
        "steer_lock": 450, "steer_ratio": 17.0,
        "stock_max_angle": 33,
        "brake_torque": 2200, "brake_bias": 0.62,
        "rotor_f_mm": 294, "rotor_r_mm": 292,
        "tire_width_f": 0.235, "tire_width_r": 0.255,
        "tire_aspect_f": 40, "tire_aspect_r": 35,
        "rim_dia_f": 17, "rim_dia_r": 17,
        "diff_type": "Torsen", "diff_power": 0.30, "diff_coast": 0.15, "diff_preload": 20,
        "power_hp": 276, "torque_nm": 314, "redline": 8000, "idle": 800,
        "fuel_capacity": 76,
    },

    # ── Toyota Supra ─────────────────────────────────────────────
    "toyota_jza80": {
        "make": "Toyota", "model": "Supra RZ", "chassis": "JZA80",
        "year": "1993-2002", "engine": "2JZ-GTE",
        "drivetrain": "RWD",
        "mass_kg": 1570,
        "wheelbase_m": 2.550,
        "track_f_m": 1.520, "track_r_m": 1.510,
        "weight_dist_f": 0.53,
        "cg_height_m": 0.46,
        "susp_type_f": "DWB", "susp_type_r": "DWB",
        "spring_rate_f": 28000, "spring_rate_r": 24000,
        "arb_f": 24000, "arb_r": 12000,
        "hub_mass_f": 38.0, "hub_mass_r": 35.0,
        "steer_lock": 450, "steer_ratio": 16.8,
        "stock_max_angle": 35,
        "brake_torque": 2400, "brake_bias": 0.63,
        "rotor_f_mm": 323, "rotor_r_mm": 313,
        "tire_width_f": 0.235, "tire_width_r": 0.255,
        "tire_aspect_f": 40, "tire_aspect_r": 40,
        "rim_dia_f": 17, "rim_dia_r": 17,
        "diff_type": "Torsen", "diff_power": 0.25, "diff_coast": 0.10, "diff_preload": 20,
        "power_hp": 321, "torque_nm": 441, "redline": 6800, "idle": 700,
        "fuel_capacity": 80,
    },

    # ── Honda S2000 ──────────────────────────────────────────────
    "honda_ap1": {
        "make": "Honda", "model": "S2000", "chassis": "AP1",
        "year": "1999-2003", "engine": "F20C",
        "drivetrain": "RWD",
        "mass_kg": 1250,
        "wheelbase_m": 2.400,
        "track_f_m": 1.470, "track_r_m": 1.510,
        "weight_dist_f": 0.50,
        "cg_height_m": 0.42,
        "susp_type_f": "DWB", "susp_type_r": "DWB",
        "spring_rate_f": 28000, "spring_rate_r": 32000,
        "arb_f": 18000, "arb_r": 10000,
        "hub_mass_f": 28.0, "hub_mass_r": 26.0,
        "steer_lock": 420, "steer_ratio": 16.5,
        "stock_max_angle": 35,
        "brake_torque": 2000, "brake_bias": 0.62,
        "rotor_f_mm": 300, "rotor_r_mm": 282,
        "tire_width_f": 0.205, "tire_width_r": 0.225,
        "tire_aspect_f": 55, "tire_aspect_r": 50,
        "rim_dia_f": 16, "rim_dia_r": 16,
        "diff_type": "Torsen", "diff_power": 0.30, "diff_coast": 0.15, "diff_preload": 15,
        "power_hp": 240, "torque_nm": 208, "redline": 9000, "idle": 800,
        "fuel_capacity": 50,
    },

    # ── Nissan 350Z ──────────────────────────────────────────────
    "nissan_z33": {
        "make": "Nissan", "model": "350Z", "chassis": "Z33",
        "year": "2002-2009", "engine": "VQ35DE",
        "drivetrain": "RWD",
        "mass_kg": 1480,
        "wheelbase_m": 2.650,
        "track_f_m": 1.535, "track_r_m": 1.545,
        "weight_dist_f": 0.53,
        "cg_height_m": 0.45,
        "susp_type_f": "DWB", "susp_type_r": "MULTILINK",
        "spring_rate_f": 28000, "spring_rate_r": 26000,
        "arb_f": 24000, "arb_r": 14000,
        "hub_mass_f": 35.0, "hub_mass_r": 32.0,
        "steer_lock": 450, "steer_ratio": 16.5,
        "stock_max_angle": 35,
        "brake_torque": 2400, "brake_bias": 0.63,
        "rotor_f_mm": 324, "rotor_r_mm": 292,
        "tire_width_f": 0.225, "tire_width_r": 0.245,
        "tire_aspect_f": 45, "tire_aspect_r": 45,
        "rim_dia_f": 18, "rim_dia_r": 18,
        "diff_type": "VLSD", "diff_power": 0.20, "diff_coast": 0.08, "diff_preload": 15,
        "power_hp": 287, "torque_nm": 371, "redline": 6800, "idle": 700,
        "fuel_capacity": 76,
    },

    # ── Mitsubishi Evo ───────────────────────────────────────────
    "mitsubishi_evo9": {
        "make": "Mitsubishi", "model": "Lancer Evolution IX", "chassis": "CT9A",
        "year": "2005-2007", "engine": "4G63T",
        "drivetrain": "AWD",
        "mass_kg": 1410,
        "wheelbase_m": 2.625,
        "track_f_m": 1.515, "track_r_m": 1.530,
        "weight_dist_f": 0.57,
        "cg_height_m": 0.48,
        "susp_type_f": "STRUT", "susp_type_r": "MULTILINK",
        "spring_rate_f": 30000, "spring_rate_r": 28000,
        "arb_f": 25000, "arb_r": 15000,
        "hub_mass_f": 35.0, "hub_mass_r": 32.0,
        "steer_lock": 450, "steer_ratio": 15.0,
        "stock_max_angle": 38,
        "brake_torque": 2800, "brake_bias": 0.60,
        "rotor_f_mm": 320, "rotor_r_mm": 300,
        "tire_width_f": 0.235, "tire_width_r": 0.235,
        "tire_aspect_f": 45, "tire_aspect_r": 45,
        "rim_dia_f": 17, "rim_dia_r": 17,
        "diff_type": "Active Center + Rear LSD", "diff_power": 0.35, "diff_coast": 0.15, "diff_preload": 30,
        "power_hp": 286, "torque_nm": 400, "redline": 7000, "idle": 800,
        "fuel_capacity": 55,
    },

    # ── Subaru WRX STI ───────────────────────────────────────────
    "subaru_gdb": {
        "make": "Subaru", "model": "Impreza WRX STI", "chassis": "GDB",
        "year": "2001-2007", "engine": "EJ207",
        "drivetrain": "AWD",
        "mass_kg": 1430,
        "wheelbase_m": 2.525,
        "track_f_m": 1.490, "track_r_m": 1.485,
        "weight_dist_f": 0.58,
        "cg_height_m": 0.48,
        "susp_type_f": "STRUT", "susp_type_r": "DWB",
        "spring_rate_f": 30000, "spring_rate_r": 26000,
        "arb_f": 28000, "arb_r": 16000,
        "hub_mass_f": 34.0, "hub_mass_r": 32.0,
        "steer_lock": 450, "steer_ratio": 15.0,
        "stock_max_angle": 38,
        "brake_torque": 2800, "brake_bias": 0.60,
        "rotor_f_mm": 326, "rotor_r_mm": 290,
        "tire_width_f": 0.225, "tire_width_r": 0.225,
        "tire_aspect_f": 45, "tire_aspect_r": 45,
        "rim_dia_f": 17, "rim_dia_r": 17,
        "diff_type": "DCCD Center + Rear Torsen", "diff_power": 0.35, "diff_coast": 0.15, "diff_preload": 30,
        "power_hp": 280, "torque_nm": 392, "redline": 7000, "idle": 750,
        "fuel_capacity": 60,
    },
}


def get_cars_by_make():
    """Return cars grouped by make for UI display."""
    grouped = {}
    for car_id, car in CAR_DATABASE.items():
        make = car["make"]
        if make not in grouped:
            grouped[make] = []
        grouped[make].append({"id": car_id, **car})
    return dict(sorted(grouped.items()))


def get_car(car_id):
    """Get a car by ID."""
    return CAR_DATABASE.get(car_id)
